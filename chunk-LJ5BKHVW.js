import{d as f}from"./chunk-OWSZPSB2.js";import{Ga as m,Ha as u,Ka as d,bc as g,qb as a,zb as p}from"./chunk-Q2JYTUQO.js";var v=class o{constructor(e,t){this.el=e;this.zone=t}country;types;placeSelected=new m;autocomplete;listener;ngAfterViewInit(){let e=()=>{let n=this.el.nativeElement,r={types:this.types??["(cities)"],fields:["address_components","geometry","formatted_address"],componentRestrictions:this.country?{country:this.country}:void 0};this.autocomplete=new google.maps.places.Autocomplete(n,r),this.listener=this.autocomplete.addListener("place_changed",()=>{this.zone.run(()=>{let i=this.autocomplete.getPlace(),{city:s,formatted:c}=E(i),l=i.geometry?.location??null;this.placeSelected.emit({city:s||c,lat:l?l.lat():null,lng:l?l.lng():null,formattedAddress:c}),s&&(n.value=s)})})};if(window.google?.maps?.places){e();return}let t=setInterval(()=>{window.google?.maps?.places&&(clearInterval(t),e())},100)}ngOnDestroy(){this.listener?.remove()}static \u0275fac=function(t){return new(t||o)(a(d),a(u))};static \u0275dir=p({type:o,selectors:[["","placesAutocomplete",""]],inputs:{country:"country",types:"types"},outputs:{placeSelected:"placeSelected"}})};function E(o){let e=o.formatted_address??"",t=o.address_components??[],n=h=>t.find(w=>w.types.includes(h))?.long_name||"",r=n("locality"),i=n("administrative_area_level_2"),s=n("administrative_area_level_1"),c=n("postal_town");return{city:r||c||i||s||"",formatted:e}}var N=/^[\p{Script=Hebrew}\p{Script=Latin}]+(?:[-'][\p{Script=Hebrew}\p{Script=Latin}]+)*$/u,z=o=>{let t=(typeof o.value=="string"?o.value:"").trim();if(!t)return null;let r=t.replace(/\s+/g," ").split(" ");return r.length<2?{fullnameFormat:{code:"atLeastTwoParts"}}:r.every(i=>N.test(i))?null:{fullnameFormat:{code:"lettersOnly"}}};var y=class o{constructor(e){this.ngControl=e}onBlur(){let e=this.ngControl.control;if(!e)return;let t=(e.value??"").toString(),n=t.trim().replace(/\s+/g," ");t!==n&&e.patchValue(n,{emitEvent:!1})}static \u0275fac=function(t){return new(t||o)(a(f))};static \u0275dir=p({type:o,selectors:[["","normalizeFullName",""]],hostBindings:function(t,n){t&1&&g("blur",function(){return n.onBlur()})}})};export{v as a,z as b,y as c};
